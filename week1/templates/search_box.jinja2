<div id="search-box" class="bg-blue-500 p-4"> 
  <form method="post" action="{{ url_for('search.query') }}" id="searchForm">
    <div class="sm:flex">
    <input class="flex-grow w-full sm:w-auto" name="query" id="query" type="search" value="{{ query|e }}" required>
    <input type="submit" value="Query" class="hidden">
    <div class="sm:ml-2 pt-2 sm:pt-0">
      <select name="sort" id="sortControl">
        <option value="_score" {% if sort == "_score" %}selected{% endif %} >Relevance</option>
        <option value="name.keyword" {% if sort == "name.keyword" %}selected{% endif %}>Name</option>
        <option value="salesRankShortTerm" {% if sort == "salesRankShortTerm" %}selected{% endif %}>Popularity</option>
        <option value="regularPrice" {% if sort == "regularPrice" %}selected{% endif %}>Price</option>
      </select>
      <select name="sortDir" id="sortDirControl">
        <option value="asc" {% if sortDir == "asc" %}selected{% endif %}>Ascending</option>
        <option value="desc" {% if sortDir == "desc" %}selected{% endif %}>Descending</option>
      </select>
    </div>
    </div>
  </form>
</div>

<script>
  const searchForm = document.getElementById('searchForm')
  const sortControl = document.getElementById('sortControl');
  const sortDirControl = document.getElementById('sortDirControl');
  sortControl.addEventListener('change', () => {
    searchForm.submit();
  })
  sortDirControl.addEventListener('change', () => {
    searchForm.submit();
  })
  
</script>
